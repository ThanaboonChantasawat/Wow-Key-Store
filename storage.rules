rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // อนุญาตให้อ่านได้ทุกคน
    match /{allPaths=**} {
      allow read: if true;
    }

    // Shop logos - เฉพาะผู้ใช้ที่ login แล้วเท่านั้นที่อัปโหลดได้
    match /shop-logos/{userId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == userId;
      allow delete: if request.auth != null && request.auth.uid == userId;
    }

    // Product images - เฉพาะผู้ใช้ที่ login แล้วเท่านั้นที่อัปโหลดได้
    match /products/{productId}/{fileName} {
      allow write: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // Profile images - เฉพาะเจ้าของเท่านั้น
    match /profile-images/{userId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == userId;
      allow delete: if request.auth != null && request.auth.uid == userId;
    }

    // Game images - เฉพาะ admin
    match /game-images/{gameId}/{fileName} {
      allow write: if request.auth != null;
      allow delete: if request.auth != null;
    }
  }
}
